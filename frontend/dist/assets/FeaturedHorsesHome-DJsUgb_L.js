import{d as _,r as l,R as F,j as s,L as C,e as P,u as $,f as W,g as H,S as z}from"./index-D2i5OC9q.js";/**
 * @license lucide-react v0.469.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const O=_("Loader",[["path",{d:"M12 2v4",key:"3427ic"}],["path",{d:"m16.2 7.8 2.9-2.9",key:"r700ao"}],["path",{d:"M18 12h4",key:"wj9ykh"}],["path",{d:"m16.2 16.2 2.9 2.9",key:"1bxg5t"}],["path",{d:"M12 18v4",key:"jadmvz"}],["path",{d:"m4.9 19.1 2.9-2.9",key:"bwix9q"}],["path",{d:"M2 12h4",key:"j09sii"}],["path",{d:"m4.9 4.9 2.9 2.9",key:"giyufr"}]]),D=(e,r=300)=>{const[a,o]=l.useState(e);return l.useEffect(()=>{const h=setTimeout(()=>{o(e)},r);return()=>{clearTimeout(h)}},[e,r]),a};var B=new Map,E=new WeakMap,T=0,G=void 0;function q(e){return e?(E.has(e)||(T+=1,E.set(e,T.toString())),E.get(e)):"0"}function Q(e){return Object.keys(e).sort().filter(r=>e[r]!==void 0).map(r=>`${r}_${r==="root"?q(e.root):e[r]}`).toString()}function U(e){const r=Q(e);let a=B.get(r);if(!a){const o=new Map;let h;const m=new IntersectionObserver(n=>{n.forEach(i=>{var d;const w=i.isIntersecting&&h.some(b=>i.intersectionRatio>=b);e.trackVisibility&&typeof i.isVisible>"u"&&(i.isVisible=w),(d=o.get(i.target))==null||d.forEach(b=>{b(w,i)})})},e);h=m.thresholds||(Array.isArray(e.threshold)?e.threshold:[e.threshold||0]),a={id:r,observer:m,elements:o},B.set(r,a)}return a}function Y(e,r,a={},o=G){if(typeof window.IntersectionObserver>"u"&&o!==void 0){const d=e.getBoundingClientRect();return r(o,{isIntersecting:o,target:e,intersectionRatio:typeof a.threshold=="number"?a.threshold:0,time:0,boundingClientRect:d,intersectionRect:d,rootBounds:d}),()=>{}}const{id:h,observer:m,elements:n}=U(a),i=n.get(e)||[];return n.has(e)||n.set(e,i),i.push(r),m.observe(e),function(){i.splice(i.indexOf(r),1),i.length===0&&(n.delete(e),m.unobserve(e)),n.size===0&&(m.disconnect(),B.delete(h))}}function J({threshold:e,delay:r,trackVisibility:a,rootMargin:o,root:h,triggerOnce:m,skip:n,initialInView:i,fallbackInView:d,onChange:w}={}){var b;const[y,R]=l.useState(null),j=l.useRef(w),[g,N]=l.useState({inView:!!i,entry:void 0});j.current=w,l.useEffect(()=>{if(n||!y)return;let t;return t=Y(y,(f,c)=>{N({inView:f,entry:c}),j.current&&j.current(f,c),c.isIntersecting&&m&&t&&(t(),t=void 0)},{root:h,rootMargin:o,threshold:e,trackVisibility:a,delay:r},d),()=>{t&&t()}},[Array.isArray(e)?e.toString():e,y,h,o,m,n,a,d,r]);const x=(b=g.entry)==null?void 0:b.target,u=l.useRef(void 0);!y&&x&&!m&&!n&&u.current!==x&&(u.current=x,N({inView:!!i,entry:void 0}));const v=[R,g.inView,g.entry];return v.ref=v[0],v.inView=v[1],v.entry=v[2],v}const K=({itemCount:e,itemHeight:r,columnCount:a,gap:o=24,renderItem:h,className:m=""})=>{const n=l.useRef(null),[i,d]=l.useState({start:0,end:20}),[w,b]=l.useState(0),{ref:y,inView:R}=J({threshold:0,rootMargin:"200px"}),j=(w-o*(a-1))/a,g=Math.ceil(e/a),N=g*(r+o)-o;l.useEffect(()=>{const u=()=>{n.current&&b(n.current.offsetWidth)};u();const v=new ResizeObserver(u);return n.current&&v.observe(n.current),()=>{v.disconnect()}},[]),l.useEffect(()=>{const u=()=>{if(!n.current)return;const v=n.current,t=window.scrollY-v.offsetTop,f=window.innerHeight,c=R?4:2,p=r+o,S=Math.max(0,Math.floor(t/p)-c),A=Math.min(g,Math.ceil((t+f)/p)+c),k=S*a,M=Math.min(e,A*a);d({start:k,end:M})};return u(),window.addEventListener("scroll",u,{passive:!0}),()=>window.removeEventListener("scroll",u)},[e,r,a,o,g,R]);const x=[];for(let u=i.start;u<i.end&&!(u>=e);u++){const v=Math.floor(u/a),t=u%a,f=v*(r+o),c=t*(j+o);x.push(s.jsx("div",{children:h({index:u,style:{position:"absolute",top:f,left:c,width:j,height:r}})},u))}return s.jsxs("div",{ref:n,className:`relative ${m}`,style:{height:N},children:[x,s.jsx("div",{ref:y,style:{position:"absolute",bottom:0,height:"1px"}})]})},X=F.memo(K),L=[{id:"all",label:"All Prices",value:"all",min:0,max:1/0},{id:"under100k",label:"Under ₹1,00,000",value:"under100k",min:0,max:1e5},{id:"100k-300k",label:"₹1,00,000 - ₹3,00,000",value:"100k-300k",min:1e5,max:3e5},{id:"above300k",label:"Above ₹3,00,000",value:"above300k",min:3e5,max:1/0}],Z=F.memo(({horse:e,isFavorite:r,onToggleFavorite:a})=>{var o,h,m,n,i;return s.jsxs(C,{to:`/horses/${e._id}`,className:"group bg-white rounded-lg shadow-md overflow-hidden hover:shadow-xl transition-shadow",children:[s.jsxs("div",{className:"relative aspect-[4/3] overflow-hidden",children:[s.jsx("img",{src:((h=(o=e.images)==null?void 0:o[0])==null?void 0:h.url)||"/images/placeholder-horse.jpg",alt:e.name,className:"w-full h-full object-cover group-hover:scale-105 transition-transform duration-300",loading:"lazy"}),s.jsx("button",{onClick:d=>{d.preventDefault(),a(e._id)},className:"absolute top-2 right-2 p-2 bg-white/90 rounded-full hover:bg-white transition-colors",children:s.jsx(P,{className:`w-5 h-5 ${r?"fill-red-500 text-red-500":"text-gray-600"}`})}),s.jsxs("div",{className:"absolute bottom-0 left-0 right-0 bg-gradient-to-t from-black/60 to-transparent p-4",children:[s.jsx("p",{className:"text-white font-semibold",children:e.name}),s.jsxs("p",{className:"text-white/90 text-sm",children:[e.breed," • ",((m=e.age)==null?void 0:m.years)||0," years"]})]})]}),s.jsx("div",{className:"p-4",children:s.jsxs("div",{className:"flex justify-between items-center",children:[s.jsxs("p",{className:"text-primary font-bold",children:["₹",((n=e.price)==null?void 0:n.toLocaleString())||"0"]}),s.jsx("p",{className:"text-sm text-tertiary/70",children:((i=e.location)==null?void 0:i.city)||"Location N/A"})]})})]})}),ee=({horses:e=[],breeds:r=[]})=>{const a=$(),{isAuthenticated:o}=W(),[h,m]=l.useState(""),[n,i]=l.useState(""),[d,w]=l.useState("all"),[b,y]=l.useState([]),[R,j]=l.useState(!0);l.useEffect(()=>{(async()=>{var f;if(!o){j(!1);return}try{const c=await H.users.getFavorites();if((f=c==null?void 0:c.data)!=null&&f.success){const p=c.data.favorites.map(S=>S._id);y(p)}}catch(c){console.error("Error fetching favorites:",c)}finally{j(!1)}})()},[o]);const g=D(h,300),N=l.useCallback(async t=>{var f;if(!o){a("/login",{state:{from:window.location.pathname}});return}try{const c=await H.horses.toggleFavorite(t);(f=c==null?void 0:c.data)!=null&&f.success&&y(p=>p.includes(t)?p.filter(S=>S!==t):[...p,t])}catch(c){console.error("Error toggling favorite:",c)}},[o,a]),x=l.useMemo(()=>e.filter(t=>{const f=(t.name||"").toLowerCase(),c=(t.breed||"").toLowerCase(),p=g.toLowerCase(),S=f.includes(p)||c.includes(p),A=!n||n==="All Breeds"||t.breed===n,k=L.find(I=>I.value===d)||L[0],M=t.price||0,V=d==="all"||M>=k.min&&M<=k.max;return S&&A&&V}),[e,g,n,d]),u=l.useCallback(({index:t,style:f})=>s.jsx("div",{style:f,children:s.jsx(Z,{horse:x[t],isFavorite:b.includes(x[t]._id),onToggleFavorite:N})},x[t]._id),[x,b,N]),v=l.useMemo(()=>{const t=new Set(e.map(f=>f.breed).filter(Boolean));return Array.from(t)},[e]);return s.jsx("section",{className:"py-16 bg-white",children:s.jsxs("div",{className:"max-w-7xl mx-auto px-4",children:[s.jsxs("div",{className:"flex justify-between items-center mb-8",children:[s.jsxs("div",{children:[s.jsx("h2",{className:"text-2xl font-bold text-tertiary",children:"Featured Horses"}),s.jsx("p",{className:"text-tertiary/70 mt-1",children:"Discover our handpicked selection of premium horses"})]}),s.jsxs("div",{className:"text-sm text-tertiary",children:["Showing ",x.length," of ",e.length," horses"]})]}),s.jsxs("div",{className:"flex flex-col md:flex-row gap-4 mb-8",children:[s.jsxs("div",{className:"relative flex-1",children:[s.jsx("input",{type:"text",placeholder:"Search horses...",value:h,onChange:t=>m(t.target.value),className:"w-full pl-10 pr-4 py-2 border border-secondary rounded-md focus:outline-none focus:border-primary"}),s.jsx(z,{className:"absolute left-3 top-2.5 h-5 w-5 text-tertiary"})]}),s.jsxs("select",{value:n,onChange:t=>i(t.target.value),className:"px-4 py-2 border border-secondary rounded-md focus:outline-none focus:border-primary min-w-[200px]",children:[s.jsx("option",{value:"All Breeds",children:"All Breeds"}),v.map(t=>s.jsx("option",{value:t,children:t},t))]}),s.jsx("select",{value:d,onChange:t=>w(t.target.value),className:"px-4 py-2 border border-secondary rounded-md focus:outline-none focus:border-primary min-w-[200px]",children:L.map(t=>s.jsx("option",{value:t.value,children:t.label},t.id))})]}),R?s.jsx("div",{className:"flex justify-center items-center py-12",children:s.jsx(O,{className:"w-8 h-8 animate-spin text-primary"})}):s.jsx(X,{itemCount:x.length,itemHeight:400,columnCount:3,gap:24,renderItem:u})]})})},se=F.memo(ee);export{se as default};
